# WebVPN 课程查询与选课工具

一个基于 Python Tkinter 的图形化工具，用于通过 WebVPN 查询课程信息、成绩，并支持批量选课功能。

## 功能特性

### 🔐 系统初始化
- 自动获取和验证 TGT (Ticket Granting Ticket)
- 提取用户 UUID 用于后续操作
- 支持手动输入 Ticket 或自动获取

### 📚 课程查询
- 批量获取所有可选课程信息
- 多条件过滤：
  - 课程名称/教师姓名
  - 上课时间
  - 选课要求
  - 是否已满
- 支持勾选多门课程加入抢课列表
- 实时显示课程容量和已选人数

### 📊 成绩查询
- 查询个人历史成绩
- 显示学期、课程、总评、考试成绩等信息

### ⚡ 批量选课
- 一键批量提交选课请求
- 实时显示每门课程的选课状态
- 支持移除和清空选课列表

## 环境要求

- Python 3.6+
- 依赖库：
  ```bash
  pip install requests urllib3
  ```

## 使用方法

### 1. 运行程序

```bash
python CourseQuery.py
```

### 2. 初始化系统

在"系统初始化"选项卡中：
1. 填入 TGT（从浏览器开发者工具获取）
2. 填入 Wengine Cookie 值
3. （可选）手动填入 Ticket
4. 点击"开始初始化"按钮
5. 成功后 UUID 会自动填充到其他选项卡

### 3. 查询课程

在"课程查询"选项卡中：
1. 确认 UUID 和 Wengine 已填写
2. 设置查询数量限制（默认 200）
3. 点击"获取所有课程"
4. 使用过滤条件筛选目标课程
5. 勾选需要选的课程
6. 点击"加入【批量选课】列表"

### 4. 批量选课

在"批量选课"选项卡中：
1. 确认列表中的课程
2. 点击"一键极速选课"按钮
3. 等待所有课程提交完成
4. 查看每门课程的选课结果

## 获取必要参数

### TGT 和 Wengine

1. 使用浏览器登录 WebVPN 系统
2. 打开开发者工具（F12）
3. 切换到 Network 标签
4. 在 Cookie 中找到：
   - `wengine_vpn_ticketwebvpnnew_jxau_edu_cn` 的值即为 Wengine
5. TGT 可从 CAS 认证请求中获取

## 注意事项

⚠️ **重要提示**

- 本工具仅供技术研究使用
- 请遵守学校选课规定，合理使用
- Cookie 和 Token 具有时效性，失效后需重新获取
- 建议在选课开放时间使用，避免频繁请求
- 使用前请确保已通过 WebVPN 正常登录

## 技术说明

- 使用 `tkinter` 构建图形界面
- 通过 `requests` 库发送 HTTP 请求
- 支持多线程操作，避免界面卡顿
- 禁用 SSL 证书验证以适配 WebVPN 环境

## 文件说明

- `CourseQuery.py` - 主程序，包含完整的 GUI 和功能实现
- `send_packet.py` - 简单的课程查询请求示例
- `send_request.py` - 预留的请求脚本

## 免责声明

本工具仅用于技术学习和研究目的。使用者应当遵守学校的相关规定和法律法规，作者不对使用本工具产生的任何后果负责。

## License

MIT License

---

**最后更新**: 2026年1月
